# commented out as of 2025-11-23 because dbt unit tests still have a fuck ton of issues.
# this one in particular doesn't work because of the special chars in the source table col names.

# unit_tests:
#   - name: dim_players_unit_test
#     description: "Test the players model in full refresh mode."
#     model: dim_players
#     overrides:
#       macros:
#         # unit test this model in "full refresh" mode
#         is_incremental: false
#     given:
#       - input: source('bronze', 'internal_player_attributes')
#         rows:
#           - {
#               player: "Stephen Curry",
#               is_rookie: false,
#               yrs_exp: 16,
#               headshot: "https://headshot.dev",
#               created_at: "2021-01-01 01:00:00",
#               modified_at: "2021-01-01 01:00:00",
#             }
#           - {
#               player: "Kevin Durant",
#               is_rookie: false,
#               yrs_exp: 17,
#               headshot: "https://headshot.dev",
#               created_at: "2021-01-01 01:00:00",
#               modified_at: "2021-01-01 01:00:00",
#             }
#           - {
#               player: "Paul George",
#               is_rookie: false,
#               yrs_exp: 15,
#               headshot: "https://headshot.dev",
#               created_at: "2021-01-01 01:00:00",
#               modified_at: "2021-01-01 01:00:00",
#             }
#       - input: source('bronze', 'internal_team_top_players')
#         rows:
#           - { player: "Stephen Curry", team: "GSW", rank: 1 }
#           - { player: "Kevin Durant", team: "PHX", rank: 1 }
#           - { player: "Paul George", team: "PHI", rank: 2 }
#       - input: source('bronze', 'bbref_player_contracts')
#         rows:
#           - { player: "Stephen Curry", season_salary: 53500000 }
#           - { player: "Kevin Durant", season_salary: 47500000 }
#           - { player: "Paul George", season_salary: 47500000 }
#       - input: source('bronze', 'bbref_player_adv_stats')
#         rows:
#           - {
#               rk: null,
#               player: "Stephen Curry",
#               age: null,
#               team: null,
#               pos: "PG",
#               g: null,
#               gs: null,
#               mp: null,
#               per: 24.8,
#               "ts%": null,
#               "3par": null,
#               ftr: null,
#               "orb%": null,
#               "drb%": null,
#               "trb%": null,
#               "ast%": null,
#               "stl%": null,
#               "blk%": null,
#               "tov%": null,
#               "usg%": null,
#               ows: null,
#               dws: null,
#               ws: 10.5,
#               "ws/48": 0.185,
#               obpm: null,
#               dbpm: null,
#               bpm: 6.1,
#               vorp: 5.2,
#               awards: null,
#               created_at: null,
#               modified_at: null,
#             }
#           - {
#               rk: null,
#               player: "Kevin Durant",
#               age: null,
#               team: null,
#               pos: "PF",
#               g: null,
#               gs: null,
#               mp: null,
#               per: 26.3,
#               "ts%": null,
#               "3par": null,
#               ftr: null,
#               "orb%": null,
#               "drb%": null,
#               "trb%": null,
#               "ast%": null,
#               "stl%": null,
#               "blk%": null,
#               "tov%": null,
#               "usg%": null,
#               ows: null,
#               dws: null,
#               ws: 9.8,
#               "ws/48": 0.192,
#               obpm: null,
#               dbpm: null,
#               bpm: 5.9,
#               vorp: 4.8,
#               awards: null,
#               created_at: null,
#               modified_at: null,
#             }
#           - {
#               rk: null,
#               player: "Paul George",
#               age: null,
#               team: null,
#               pos: "SF",
#               g: null,
#               gs: null,
#               mp: null,
#               per: 22.1,
#               "ts%": null,
#               "3par": null,
#               ftr: null,
#               "orb%": null,
#               "drb%": null,
#               "trb%": null,
#               "ast%": null,
#               "stl%": null,
#               "blk%": null,
#               "tov%": null,
#               "usg%": null,
#               ows: null,
#               dws: null,
#               ws: 8.1,
#               "ws/48": 0.168,
#               obpm: null,
#               dbpm: null,
#               bpm: 4.2,
#               vorp: 3.9,
#               awards: null,
#               created_at: null,
#               modified_at: null,
#             }

#     expect:
#       rows:
#         - {
#             player: "Stephen Curry",
#             is_rookie: false,
#             yrs_exp: 16,
#             headshot: "https://headshot.dev",
#             salary: 1000000,
#             rank: 1,
#             pos: "PG",
#             vorp: 5.2,
#             per: 24.8,
#             bpm: 6.1,
#             ws_per_48: 0.185,
#             created_at: "2021-01-01 01:00:00",
#             modified_at: "2021-01-01 01:00:00",
#           }
#         - {
#             player: "Kevin Durant",
#             is_rookie: false,
#             yrs_exp: 17,
#             headshot: "https://headshot.dev",
#             salary: 1000000,
#             rank: 1,
#             pos: "PF",
#             vorp: 4.8,
#             per: 26.3,
#             bpm: 5.9,
#             ws_per_48: 0.192,
#             created_at: "2021-01-01 01:00:00",
#             modified_at: "2021-01-01 01:00:00",
#           }
#         - {
#             player: "Paul George",
#             is_rookie: false,
#             yrs_exp: 15,
#             headshot: "https://headshot.dev",
#             salary: 1000000,
#             rank: 2,
#             pos: "SF",
#             vorp: 3.9,
#             per: 22.1,
#             bpm: 4.2,
#             ws_per_48: 0.168,
#             created_at: "2021-01-01 01:00:00",
#             modified_at: "2021-01-01 01:00:00",
#           }
